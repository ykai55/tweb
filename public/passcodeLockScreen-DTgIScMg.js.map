{"version":3,"file":"passcodeLockScreen-DTgIScMg.js","sources":["../src/components/passcodeLock/passwordMonkeyTsx.tsx","../src/components/passcodeLock/simplePopup.tsx","../src/components/passcodeLock/background.tsx","../src/components/passcodeLock/passcodeLockScreen.tsx"],"sourcesContent":["import {Component, createRenderEffect, createSignal, mergeProps, onCleanup, Ref, Show} from 'solid-js';\n\nimport {useLockScreenHotReloadGuard} from '../../lib/solidjs/hotReloadGuard';\n\nimport type PasswordInputField from '../passwordInputField';\nimport type PasswordMonkey from '../monkeys/password';\n\nimport styles from './passwordMonkeyTsx.module.scss';\n\n\nconst PasswordMonkeyTsx: Component<{\n  ref?: Ref<HTMLDivElement>;\n  passwordInputField: PasswordInputField;\n  hidden?: boolean;\n  size?: number;\n}> = (inProps) => {\n  const props = mergeProps({size: 100}, inProps);\n\n  const {PasswordMonkey} = useLockScreenHotReloadGuard();\n\n  const [monkey, setMonkey] = createSignal<PasswordMonkey>();\n  const [monkeyLoaded, setMonkeyLoaded] = createSignal(false);\n\n  createRenderEffect(() => {\n    const monkey = new PasswordMonkey(props.passwordInputField, props.size);\n    monkey.load().then(() => setMonkeyLoaded(true));\n    setMonkey(monkey);\n\n    onCleanup(() => {\n      monkey.remove();\n    });\n  });\n\n  return (\n    <div\n      ref={props.ref}\n      class={styles.PasswordMonkey}\n      classList={{\n        [styles.hidden]: props.hidden\n      }}\n      style={{'--size': props.size + 'px'}}\n    >\n      {monkey().container}\n\n      {/* Prevent the monkey blinking when reloading the page */}\n      <Show when={!monkeyLoaded()}>\n        <img class={styles.MonkeyImage} src=\"assets/img/password-monkey-closed.png\" />\n      </Show>\n    </div>\n  );\n};\n\nexport default PasswordMonkeyTsx;\n","import {Component, JSX, onCleanup, onMount} from 'solid-js';\nimport {Transition} from 'solid-transition-group';\nimport {Portal} from 'solid-js/web';\n\nimport pause from '../../helpers/schedulers/pause';\nimport {i18n} from '../../lib/langPack';\n\nimport ripple from '../ripple'; ripple; // keep\n\nimport styles from './simplePopup.module.scss';\n\nconst SimplePopup: Component<{\n  visible?: boolean;\n\n  title: JSX.Element;\n  description: JSX.Element;\n  confirmButtonContent: JSX.Element;\n\n  onClose?: () => void;\n  onConfirm: () => void;\n}> = (props) => {\n  onMount(() => {\n    const listener = (e: KeyboardEvent) => {\n      if(e.key === 'Escape') props.onClose?.();\n    }\n    document.addEventListener('keydown', listener);\n\n    onCleanup(() => {\n      document.removeEventListener('keydown', listener);\n    });\n  });\n\n  return (\n    <Portal>\n      <Transition\n        onEnter={async(el, done) => {\n          await pause(0);\n          el.classList.add('active');\n          await pause(0);\n          done();\n        }}\n        onExit={async(el, done) => {\n          el.classList.remove('active');\n          await pause(200);\n          done();\n        }}\n      >\n        {props.visible && <div\n          class={'popup popup-peer popup-confirmation ' + styles.Popup}\n          onClick={(e) => {\n            if(e.target === e.currentTarget) {\n              props.onClose?.();\n            }\n          }}\n        >\n          <div class='popup-container'>\n            <div class='popup-header'>\n              <div class='popup-title'>\n                {props.title}\n              </div>\n            </div>\n\n            <div class='popup-description'>\n              {props.description}\n            </div>\n\n            <div class='popup-buttons'>\n              <button class='popup-button btn danger' use:ripple onClick={props.onConfirm}>\n                {props.confirmButtonContent}\n              </button>\n              <button class='popup-button btn primary' use:ripple onClick={props.onClose} autofocus>\n                {i18n('Cancel')}\n              </button>\n            </div>\n          </div>\n        </div>}\n      </Transition>\n    </Portal>\n  );\n};\n\nexport default SimplePopup;\n","import {Component, Show} from 'solid-js';\n\nimport {useLockScreenHotReloadGuard} from '../../lib/solidjs/hotReloadGuard';\nimport {ScreenSize} from '../../helpers/mediaSizes';\n\nimport ChatBackgroundGradientRenderer from '../chat/gradientRenderer';\n\nimport useScreenSize from '../../hooks/useScreenSize';\nimport {ChatBackground} from '../chat/bubbles/chatBackground';\n\n\nconst Background: Component<{\n  gradientRendererRef: (value: ChatBackgroundGradientRenderer | undefined) => void\n}> = (props) => {\n  const {themeController, rootScope} = useLockScreenHotReloadGuard();\n\n  const screenSize = useScreenSize();\n\n  return (\n    <Show when={screenSize() !== ScreenSize.mobile}>\n      <ChatBackground\n        themeController={themeController}\n        managers={rootScope.managers}\n        gradientRendererRef={props.gradientRendererRef}\n      />\n    </Show>\n  );\n};\n\nexport default Background;\n","import {Component, createEffect, createResource, on, onCleanup, onMount, Show} from 'solid-js';\nimport {createMutable} from 'solid-js/store';\n\nimport {useLockScreenHotReloadGuard} from '../../lib/solidjs/hotReloadGuard';\nimport AccountController from '../../lib/accounts/accountController';\nimport {MAX_PASSCODE_LENGTH} from '../../lib/passcode/constants';\nimport {usePasscodeActions} from '../../lib/passcode/actions';\nimport commonStateStorage from '../../lib/commonStateStorage';\nimport throttle from '../../helpers/schedulers/throttle';\nimport focusInput from '../../helpers/dom/focusInput';\nimport pause from '../../helpers/schedulers/pause';\nimport {i18n} from '../../lib/langPack';\n\nimport ChatBackgroundGradientRenderer from '../chat/gradientRenderer';\nimport type PasswordInputField from '../passwordInputField';\nimport {animateValue} from '../mediaEditor/utils';\nimport ripple from '../ripple'; ripple; // keep\nimport Space from '../space';\n\nimport PasswordMonkeyTsx from './passwordMonkeyTsx';\nimport SimplePopup from './simplePopup';\nimport Background from './background';\n\nimport styles from './passcodeLockScreen.module.scss';\nimport {ChatBackground} from '../chat/bubbles/chatBackground';\n\n\ntype StateStore = {\n  isMonkeyHidden: boolean;\n  isError: boolean;\n  tooManyAttempts: boolean;\n  passcode: string;\n  isLogoutPopupOpen: boolean;\n  gradientRenderer?: ChatBackgroundGradientRenderer;\n};\n\n\nconst MAX_ATTEMPTS = 5;\nconst MAX_ATTEMPTS_TIMEOUT_SEC = 60;\n\n\nconst PasscodeLockScreen: Component<{\n  onUnlock: () => void;\n  fromLockIcon?: HTMLElement;\n  onAnimationEnd?: () => void;\n}> = (props) => {\n  let container: HTMLDivElement;\n  let passwordInputField: PasswordInputField;\n  let passwordMonkeyContainer: HTMLDivElement;\n\n  let attempts = 0;\n\n  const {isMyPasscode, unlockWithPasscode} = usePasscodeActions();\n  const {InputFieldTsx, PasswordInputField, apiManagerProxy} = useLockScreenHotReloadGuard();\n\n  const store = createMutable<StateStore>({\n    isMonkeyHidden: !!props.fromLockIcon,\n    isError: false,\n    tooManyAttempts: false,\n    passcode: '',\n    isLogoutPopupOpen: false\n  });\n\n  const [totalAccounts] = createResource(() => AccountController.getUnencryptedTotalAccounts());\n\n  onMount(() => {\n    attempts = 0;\n\n    const lockIcon = props.fromLockIcon;\n    if(lockIcon) (async() => {\n      const lockIconRect = lockIcon.getBoundingClientRect();\n      const rect = passwordMonkeyContainer.getBoundingClientRect();\n\n      lockIcon.style.setProperty('--x', (rect.left + (rect.width / 2)) + 'px');\n      lockIcon.style.setProperty('--y', (rect.top + (rect.height / 2)) + 'px');\n      lockIcon.style.setProperty('--scale', (rect.width / lockIconRect.width) + '');\n      lockIcon.classList.add('passcode-lock-screen__animated-lock-icon--shift-body')\n\n      await pause(500);\n\n      lockIcon.classList.add('passcode-lock-screen__animated-lock-icon--disappear')\n      store.isMonkeyHidden = false;\n\n      await pause(400);\n      lockIcon.remove();\n      props.onAnimationEnd?.();\n    })();\n\n    const listener = (e: KeyboardEvent) => {\n      if(document.activeElement && document.activeElement.tagName === 'INPUT') return;\n      focusInput(passwordInputField.input, e);\n    };\n    document.addEventListener('keydown', listener);\n    onCleanup(() => {\n      document.removeEventListener('keydown', listener);\n    });\n  });\n\n  let cancelAnimation: () => void;\n\n  function rotateBackgroundGradient() {\n    cancelAnimation?.();\n\n    if(store.gradientRenderer) {\n      let progress = 0;\n      cancelAnimation = animateValue(0, 1, 200, (p) => progress = p);\n      store.gradientRenderer.toNextPosition(() => progress);\n    }\n  }\n\n  const rotateBackgroundGradientThrottled = throttle(rotateBackgroundGradient, 100, true);\n\n  createEffect(on(() => store.passcode, () => {\n    rotateBackgroundGradientThrottled();\n\n    store.isError = false;\n    store.tooManyAttempts = false;\n  }));\n\n  onCleanup(() => {\n    store.passcode = '';\n    (passwordInputField.input as HTMLInputElement).value = '';\n  });\n\n  const canSubmit = () => !!store.passcode && store.passcode.length <= MAX_PASSCODE_LENGTH;\n\n  const canAttempt = async() => {\n    const settings = structuredClone(await commonStateStorage.get('settings', false));\n    const canAttemptAgainOn = settings?.passcode?.canAttemptAgainOn;\n    if(!canAttemptAgainOn) return true;\n\n    if(canAttemptAgainOn > Date.now()) return false;\n\n    store.tooManyAttempts = false;\n    attempts = 0;\n    settings.passcode.canAttemptAgainOn = null;\n    commonStateStorage.set({settings});\n    return true;\n  };\n\n  let isSubmiting = false;\n  const onSubmit = async(e?: Event) => {\n    e?.preventDefault();\n    if(isSubmiting) return;\n\n    isSubmiting = true;\n\n    try {\n      if(!(await canAttempt())) {\n        store.tooManyAttempts = true;\n      } else if(canSubmit() && await isMyPasscode(store.passcode)) {\n        await unlockWithPasscode(store.passcode);\n        props.onUnlock();\n      } else {\n        attempts ++;\n        store.isError = true;\n        if(attempts > MAX_ATTEMPTS) {\n          store.tooManyAttempts = true;\n          const settings = structuredClone(await commonStateStorage.get('settings', false));\n          settings.passcode.canAttemptAgainOn = Date.now() + MAX_ATTEMPTS_TIMEOUT_SEC * 1000;\n          await commonStateStorage.set({settings});\n        }\n      }\n    } catch{\n      store.isError = true;\n    } finally {\n      isSubmiting = false;\n    }\n  };\n\n  const input = (\n    <InputFieldTsx\n      InputFieldClass={PasswordInputField}\n      instanceRef={(value) => void (passwordInputField = value)}\n      class={styles.Input}\n      value={store.passcode}\n      onRawInput={(value) => void (store.passcode = value)}\n      label=\"PasscodeLock.EnterYourPasscode\"\n      errorLabel={\n        store.tooManyAttempts ?\n          'PasscodeLock.TooManyAttempts' :\n          store.isError ?\n            'PasscodeLock.WrongPasscode' :\n            undefined\n      }\n      maxLength={MAX_PASSCODE_LENGTH}\n    />\n  );\n\n\n  return (\n    <div ref={container} class={styles.Container}>\n      <Background gradientRendererRef={(value) => void(store.gradientRenderer = value)} />\n      <div class={styles.Card}>\n        <PasswordMonkeyTsx\n          hidden={store.isMonkeyHidden}\n          ref={passwordMonkeyContainer}\n          passwordInputField={passwordInputField}\n        />\n        <Space amount=\"1.125rem\" />\n        <form action=\"\" onSubmit={onSubmit}>\n          {input}\n          <Space amount=\"1rem\" />\n          <button\n            type='button'\n            onMouseDown={() => {\n              onSubmit();\n            }}\n            class={`btn-primary btn-color-primary btn-large ${styles.SubmitButton}`}\n            disabled={!store.passcode}\n          >\n            {i18n('PasscodeLock.Proceed')}\n          </button>\n          <button hidden style={{visibility: 'hidden', height: '0', width: '0'}} type='submit' />\n        </form>\n        <Space amount=\"1.625rem\" />\n        <div class={styles.Description}>\n          {\n            i18n(\n              totalAccounts() > 1 ? // Gonna be `false` when undefined\n                'PasscodeLock.ForgotPasscode.MultipleAccounts' :\n                'PasscodeLock.ForgotPasscode.OneAccount',\n              [\n                <button\n                  class={styles.LogoutButton}\n                  onClick={() => {\n                    store.isLogoutPopupOpen = true;\n                  }}\n                /> as HTMLButtonElement\n              ]\n            )\n          }\n        </div>\n      </div>\n\n      <SimplePopup\n        visible={store.isLogoutPopupOpen}\n        title={i18n('LogOut')}\n        description={i18n('PasscodeLock.LogoutPopup.Description')}\n        confirmButtonContent={i18n('LogOut')}\n        onConfirm={() => {\n          apiManagerProxy.invokeVoid('forceLogout', undefined);\n          // store.isLogoutPopupOpen = false\n        }}\n        onClose={() => void(store.isLogoutPopupOpen = false)}\n      />\n    </div>\n  );\n};\n\nexport default PasscodeLockScreen;\n"],"names":["PasswordMonkeyTsx","inProps","props","mergeProps","size","PasswordMonkey","useLockScreenHotReloadGuard","monkey","setMonkey","createSignal","monkeyLoaded","setMonkeyLoaded","createRenderEffect","passwordInputField","load","then","onCleanup","remove","_el$","_tmpl$2","_ref$","ref","_$use","_$insert","container","_$createComponent","Show","when","children","_el$2","_tmpl$","_$effect","_$className","styles","MonkeyImage","_p$","_v$","_v$2","hidden","_v$3","_$classList","style","setProperty","removeProperty","undefined","SimplePopup","onMount","listener","e","key","onClose","document","addEventListener","removeEventListener","Portal","Transition","onEnter","el","done","pause","classList","add","onExit","_$memo","visible","firstChild","_el$3","_el$4","_el$5","nextSibling","_el$6","_el$7","_el$8","$$click","target","currentTarget","title","description","_$addEventListener","onConfirm","ripple","confirmButtonContent","i18n","Popup","_$delegateEvents","Background","themeController","rootScope","screenSize","useScreenSize","ScreenSize","mobile","ChatBackground","managers","gradientRendererRef","MAX_ATTEMPTS","MAX_ATTEMPTS_TIMEOUT_SEC","PasscodeLockScreen","passwordMonkeyContainer","attempts","isMyPasscode","unlockWithPasscode","usePasscodeActions","InputFieldTsx","PasswordInputField","apiManagerProxy","store","createMutable","isMonkeyHidden","fromLockIcon","isError","tooManyAttempts","passcode","isLogoutPopupOpen","totalAccounts","createResource","AccountController","getUnencryptedTotalAccounts","lockIcon","lockIconRect","getBoundingClientRect","rect","left","width","top","height","onAnimationEnd","activeElement","tagName","focusInput","input","cancelAnimation","rotateBackgroundGradient","gradientRenderer","progress","animateValue","p","toNextPosition","rotateBackgroundGradientThrottled","throttle","createEffect","on","value","canSubmit","length","MAX_PASSCODE_LENGTH","canAttempt","settings","structuredClone","commonStateStorage","get","canAttemptAgainOn","Date","now","set","isSubmiting","onSubmit","preventDefault","onUnlock","InputFieldClass","instanceRef","Input","onRawInput","label","errorLabel","maxLength","r$","_ref$2","Space","amount","$$mousedown","LogoutButton","invokeVoid","Container","Card","SubmitButton","_v$4","_v$5","Description","disabled"],"mappings":"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"}
{"version":3,"file":"chargeForMessasgesSection-DdrUSn-i.js","sources":["../src/components/sidebarRight/tabs/groupPermissions/chargeForMessasgesSection.tsx"],"sourcesContent":["import {Component, ComponentProps, createComputed, createEffect, createSignal, Show} from 'solid-js';\nimport {render} from 'solid-js/web';\nimport {Transition} from 'solid-transition-group';\n\nimport type SolidJSHotReloadGuardProvider from '../../../../lib/solidjs/hotReloadGuardProvider';\nimport {i18n} from '../../../../lib/langPack';\n\nimport useStarsCommissionAndWithdrawalPrice from '../../../sidebarLeft/tabs/privacy/messages/useStarsCommissionAndWithdrawalPrice';\nimport {PromiseCollector} from '../../../sidebarLeft/tabs/solidJsTabs/promiseCollector';\nimport StarRangeInput from '../../../sidebarLeft/tabs/privacy/messages/starsRangeInput';\nimport StaticSwitch from '../../../staticSwitch';\nimport Section from '../../../section';\nimport RowTsx from '../../../rowTsx';\n\n\nconst TRANSITION_PARAMS: KeyframeAnimationOptions = {duration: 200, easing: 'ease-out'};\n\nconst ChargeForMessasgesSection: Component<{\n  initialStars: number;\n  onStarsChange: (amount: number) => void;\n}> = (props) => {\n  const [checked, setChecked] = createSignal(!!props.initialStars);\n  const [stars, setStars] = createSignal(props.initialStars || 0);\n\n  const {commissionPercents, willReceiveDollars} = useStarsCommissionAndWithdrawalPrice(stars);\n\n  createComputed(() => {\n    if(checked()) {\n      setStars(prev => prev || props.initialStars || 1);\n    } else {\n      setStars(0);\n    }\n  });\n\n  let first = true;\n  createEffect(() => {\n    if(first) {\n      first = false;\n      stars();\n      return;\n    }\n\n    props.onStarsChange(stars());\n  });\n\n  return (\n    <>\n      <Section caption='PaidMessages.ChargeForGroupMessagesDescription'>\n        <RowTsx\n          rightContent={\n            <StaticSwitch checked={checked()} />\n          }\n          clickable={() => {setChecked(p => !p)}}\n          title={i18n('PaidMessages.ChargeForMessages')}\n        />\n      </Section>\n      <Transition\n        onEnter={async(el, done) => {\n          const height = el.scrollHeight;\n          await el.animate({height: ['0px', height + 'px']}, TRANSITION_PARAMS).finished;\n\n          done();\n        }}\n        onExit={async(el, done) => {\n          const height = el.clientHeight;\n          await el.animate({\n            height: [height + 'px', '0px'],\n            opacity: [1, 0]\n          }, TRANSITION_PARAMS).finished;\n\n          done();\n        }}\n      >\n        <Show when={checked()}>\n          <Section\n            name='PaidMessages.SetPrice'\n            class='overflow-hidden'\n            caption='PaidMessages.SetPriceGroupDescription'\n            captionArgs={[\n              commissionPercents(),\n              willReceiveDollars()\n            ]}\n          >\n            <StarRangeInput value={stars()} onChange={setStars} />\n          </Section>\n        </Show>\n      </Transition>\n    </>\n  );\n};\n\nconst createChargeForMessasgesSection = (\n  props: ComponentProps<typeof ChargeForMessasgesSection>,\n  HotReloadProvider: typeof SolidJSHotReloadGuardProvider\n) => {\n  const element = document.createElement('div');\n\n  const promiseCollectorHelper = PromiseCollector.createHelper();\n\n  const dispose = render(() => (\n    <HotReloadProvider>\n      <PromiseCollector onCollect={promiseCollectorHelper.onCollect}>\n        <ChargeForMessasgesSection {...props} />\n      </PromiseCollector>\n    </HotReloadProvider>\n  ), element);\n\n  return {\n    element,\n    dispose,\n    promise: promiseCollectorHelper.await()\n  }\n};\n\nexport default createChargeForMessasgesSection;\n"],"names":["TRANSITION_PARAMS","duration","easing","ChargeForMessasgesSection","props","checked","setChecked","createSignal","initialStars","stars","setStars","commissionPercents","willReceiveDollars","useStarsCommissionAndWithdrawalPrice","createComputed","prev","first","createEffect","onStarsChange","_$createComponent","Section","caption","children","RowTsx","rightContent","StaticSwitch","clickable","p","title","i18n","Transition","onEnter","el","done","height","scrollHeight","animate","finished","onExit","clientHeight","opacity","Show","when","name","captionArgs","StarRangeInput","value","onChange","createChargeForMessasgesSection","HotReloadProvider","element","document","createElement","promiseCollectorHelper","PromiseCollector","createHelper","dispose","render","onCollect","promise","await"],"mappings":"iqBAeA,MAAMA,EAA8C,CAACC,SAAU,IAAKC,OAAQ,UAAU,EAEhFC,EAGAC,GAAU,CACd,KAAM,CAACC,EAASC,CAAU,EAAIC,EAAa,CAAC,CAACH,EAAMI,YAAY,EACzD,CAACC,EAAOC,CAAQ,EAAIH,EAAaH,EAAMI,cAAgB,CAAC,EAExD,CAACG,mBAAAA,EAAoBC,mBAAAA,CAAkB,EAAIC,EAAqCJ,CAAK,EAE3FK,EAAe,IAAM,CAChBT,EAAO,EACRK,EAASK,GAAQA,GAAQX,EAAMI,cAAgB,CAAC,EAEhDE,EAAS,CAAC,CAEd,CAAC,EAED,IAAIM,EAAQ,GACZC,OAAAA,EAAa,IAAM,CACjB,GAAGD,EAAO,CACRA,EAAQ,GACRP,IACA,MACF,CAEAL,EAAMc,cAAcT,EAAK,CAAE,CAC7B,CAAC,EAEDU,CAAAA,EAEKC,EAAO,CAACC,QAAO,iDAAA,IAAAC,UAAA,CAAA,OAAAH,EACbI,EAAM,CAAA,IACLC,cAAY,CAAA,OAAAL,EACTM,EAAY,CAAA,IAACpB,SAAO,CAAA,OAAEA,EAAO,CAAE,CAAA,CAAA,CAAA,EAElCqB,UAAWA,IAAM,CAACpB,EAAWqB,GAAK,CAACA,CAAC,CAAE,EAAA,IACtCC,OAAK,CAAA,OAAEC,EAAK,gCAAgC,CAAC,CAAA,CAAA,CAAA,EAAAV,EAAAA,EAGhDW,EAAU,CACTC,QAAS,MAAMC,EAAIC,IAAS,CAC1B,MAAMC,EAASF,EAAGG,aAClB,MAAMH,EAAGI,QAAQ,CAACF,OAAQ,CAAC,MAAOA,EAAS,IAAI,CAAC,EAAGlC,CAAiB,EAAEqC,SAEtEJ,GACD,EACDK,OAAQ,MAAMN,EAAIC,IAAS,CACzB,MAAMC,EAASF,EAAGO,aAClB,MAAMP,EAAGI,QAAQ,CACfF,OAAQ,CAACA,EAAS,KAAM,KAAK,EAC7BM,QAAS,CAAC,EAAG,CAAC,CAChB,EAAGxC,CAAiB,EAAEqC,SAEtBJ,GACD,EAAA,IAAAX,UAAA,CAAA,OAAAH,EAEAsB,EAAI,CAAA,IAACC,MAAI,CAAA,OAAErC,EAAO,CAAE,EAAA,IAAAiB,UAAA,CAAA,OAAAH,EAClBC,EAAO,CACNuB,KAAI,wBAAA,MAAA,kBAEJtB,QAAO,wCAAA,IACPuB,aAAW,CAAA,MAAE,CACXjC,EAAkB,EAClBC,EAAkB,CAAE,CACrB,EAAA,IAAAU,UAAA,CAAA,OAAAH,EAEA0B,EAAc,CAAA,IAACC,OAAK,CAAA,OAAErC,EAAK,CAAE,EAAEsC,SAAUrC,CAAQ,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAM9D,EAEMsC,EAAkCA,CACtC5C,EACA6C,IACG,CACH,MAAMC,EAAUC,SAASC,cAAc,KAAK,EAEtCC,EAAyBC,EAAiBC,eAE1CC,EAAUC,EAAO,IAAAtC,EACpB8B,EAAiB,CAAA,IAAA3B,UAAA,CAAA,OAAAH,EACfmC,EAAgB,CAAA,IAACI,WAAS,CAAA,OAAEL,EAAuBK,SAAS,EAAA,IAAApC,UAAA,CAAA,OAAAH,EAC1DhB,EAA8BC,CAAK,CAAA,CAAA,CAAA,CAAA,EAGzC,EAAE8C,CAAO,EAEV,MAAO,CACLA,QAAAA,EACAM,QAAAA,EACAG,QAASN,EAAuBO,MAAM,EAE1C"}